schema: '2.0'
stages:
  train:
    cmd: python main.py 10 32 1 data/train/ben.npy data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    params:
      params.yaml:
        train.Z: 10
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
        train.num_epochs: 1
    outs:
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
  MCA:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
    params:
      params.yaml:
        train.mca: data/MCA.csv
      dynamic.yaml:
        malgan.id: 984c6217d8cb4da6bd79ff089cca7355
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 7f675faffb4ed0bd8d61e61792fb8d29
      size: 76627
  split:
    cmd: python scripts/split.py
    deps:
    - path: data/raw/sleipnir/benign
      hash: md5
      md5: a94ca5d3a46622b553d9d35ef8f18f0a.dir
      size: 4037404256
      nfiles: 19696
    - path: data/raw/sleipnir/malicious
      hash: md5
      md5: c7057fcf38ebd7dc19f47bd8aef0a360.dir
      size: 7173280084
      nfiles: 34994
    params:
      params.yaml:
        split.benign_dir: data/raw/sleipnir/benign
        split.malware_dir: data/raw/sleipnir/malicious
        split.random_state: 42
        split.test_size: 0.2
        split.unique_ratio: 0.09
        train.head: 10000
        train.num_features: 300
    outs:
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: data/train/mal.npy
      hash: md5
      md5: ed3a083febdb05757279dc079f3d8d04
      size: 9600128
    - path: data/valid/ben.npy
      hash: md5
      md5: de965185fd0f70e45e28dcd8637ca0e6
      size: 2400128
    - path: data/valid/mal.npy
      hash: md5
      md5: f58dbf3229f2bade623b00ee61408cfd
      size: 2400128
  train_malgan:
    cmd: python main.py 60 32 300 data/train/ben.npy --activation tanh data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: data/train/mal.npy
      hash: md5
      md5: ed3a083febdb05757279dc079f3d8d04
      size: 9600128
    params:
      params.yaml:
        train.Z: 60
        train.activation: tanh
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.estimators: 100
        train.malware: data/train/mal.npy
        train.name: Bachelor_10k_200-Features_random_split
        train.num_epochs: 300
      dynamic.yaml:
        detector.id: d53507904a6649ee89a4b0d4980e5a62
  train_mca:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: data/train/mal.npy
      hash: md5
      md5: ed3a083febdb05757279dc079f3d8d04
      size: 9600128
    params:
      params.yaml:
        train.estimators: 100
        train.head: 10000
        train.mca: data/MCA.csv
        train.mca_components: 10
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: babf0a78e839c2c151b8a77eca990fe1
      size: 3299960
  train_mca_classifier:
    cmd: python mca_classifier.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: babf0a78e839c2c151b8a77eca990fe1
      size: 3299960
    params:
      params.yaml:
        train.estimators: 100
        train.mca: data/MCA.csv
  graph_mca:
    cmd: python scripts/graph_mca.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: babf0a78e839c2c151b8a77eca990fe1
      size: 3299960
    outs:
    - path: outs/mca_scatter.html
      hash: md5
      md5: 16dbdbb73eb679381c0fcfdd758a8dc7
      size: 4417443
  extract_normal_features:
    cmd: python lime_normal.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: babf0a78e839c2c151b8a77eca990fe1
      size: 3299960
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: dynamic.yaml
      hash: md5
      md5: 91d16a05289ad407306c298500170e89
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
      dynamic.yaml:
        mca.id: 04efad775f894fa0a0a926ee29c2092f
        mca_classifier.id: 4966a95a859648fc844949a1283fbe74
    outs:
    - path: data/normal_features.txt
      hash: md5
      md5: e649b4198362911041c2538bcc628f73
      size: 643
  experiment_base:
    cmd: PYTHONHASHSEED=0 python experiment.py normal
    deps:
    - path: data/valid/ben.npy
      hash: md5
      md5: de965185fd0f70e45e28dcd8637ca0e6
      size: 2400128
    - path: data/valid/mal.npy
      hash: md5
      md5: f58dbf3229f2bade623b00ee61408cfd
      size: 2400128
    - path: dynamic.yaml
      hash: md5
      md5: 91d16a05289ad407306c298500170e89
      size: 195
    params:
      params.yaml:
        metrics.normal: metrics/normal.json
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: d53507904a6649ee89a4b0d4980e5a62
        malgan.id: 33efd140f9154c29ab744a0c9dfd4cd1
    outs:
    - path: metrics/normal.json
      hash: md5
      md5: a1e9cb07c134406d1ea03347d3cfc6e2
      size: 931
    - path: metrics/normal.png
      hash: md5
      md5: 943cd144e13d7abd8ce1fdb54e3b9d0d
      size: 18157
  experiment_lime:
    cmd: PYTHONHASHSEED=0 python experiment.py lime
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: babf0a78e839c2c151b8a77eca990fe1
      size: 3299960
    - path: data/normal_features.txt
      hash: md5
      md5: e649b4198362911041c2538bcc628f73
      size: 643
    - path: data/valid/ben.npy
      hash: md5
      md5: de965185fd0f70e45e28dcd8637ca0e6
      size: 2400128
    - path: data/valid/mal.npy
      hash: md5
      md5: f58dbf3229f2bade623b00ee61408cfd
      size: 2400128
    - path: dynamic.yaml
      hash: md5
      md5: 91d16a05289ad407306c298500170e89
      size: 195
    params:
      params.yaml:
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: d53507904a6649ee89a4b0d4980e5a62
        malgan.id: 33efd140f9154c29ab744a0c9dfd4cd1
        mca.id: 04efad775f894fa0a0a926ee29c2092f
        mca_classifier.id: 4966a95a859648fc844949a1283fbe74
    outs:
    - path: metrics/lime.json
      hash: md5
      md5: a1e9cb07c134406d1ea03347d3cfc6e2
      size: 931
    - path: metrics/lime.png
      hash: md5
      md5: 943cd144e13d7abd8ce1fdb54e3b9d0d
      size: 18157
    - path: metrics/lime_obf.json
      hash: md5
      md5: a1e9cb07c134406d1ea03347d3cfc6e2
      size: 931
    - path: metrics/lime_obf.png
      hash: md5
      md5: 4c2cdb44a76ea32d061a07aea8d90a3b
      size: 23082
  train_detector:
    cmd: python train_detector.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: data/train/mal.npy
      hash: md5
      md5: ed3a083febdb05757279dc079f3d8d04
      size: 9600128
    params:
      params.yaml:
        split.random_state: 42
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
  extract_normal_categorical_features:
    cmd: python lime_normal_categorical.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e635301b101c71ddb728db66fad02178
      size: 9600128
    - path: dynamic.yaml
      hash: md5
      md5: 91d16a05289ad407306c298500170e89
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.normal_categorical_features: data/normal_categorical_features.txt
      dynamic.yaml:
        detector.id: d53507904a6649ee89a4b0d4980e5a62
    outs:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 66924911ecf0538696f84f3cf16c7797
      size: 3605
  experiment_lime_categorical:
    cmd: PYTHONHASHSEED=0 python experiment.py categorical
    deps:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 66924911ecf0538696f84f3cf16c7797
      size: 3605
    - path: data/valid/ben.npy
      hash: md5
      md5: de965185fd0f70e45e28dcd8637ca0e6
      size: 2400128
    - path: data/valid/mal.npy
      hash: md5
      md5: f58dbf3229f2bade623b00ee61408cfd
      size: 2400128
    - path: dynamic.yaml
      hash: md5
      md5: 91d16a05289ad407306c298500170e89
      size: 195
    params:
      params.yaml:
        train.normal_categorical_features: data/normal_categorical_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: d53507904a6649ee89a4b0d4980e5a62
        malgan.id: 33efd140f9154c29ab744a0c9dfd4cd1
    outs:
    - path: metrics/lime_cat.json
      hash: md5
      md5: ac59b0cd253b1d01428b5a3c96e5bbba
      size: 868
    - path: metrics/lime_cat.png
      hash: md5
      md5: f4e4564b2f3df396f594805ac842f7a6
      size: 17467
    - path: metrics/lime_cat_obf.json
      hash: md5
      md5: ac59b0cd253b1d01428b5a3c96e5bbba
      size: 868
    - path: metrics/lime_cat_obf.png
      hash: md5
      md5: f7ce2ac45c2c9a511494cbdae28b6742
      size: 22681
