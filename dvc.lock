schema: '2.0'
stages:
  train:
    cmd: python main.py 10 32 1 data/train/ben.npy data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    params:
      params.yaml:
        train.Z: 10
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
        train.num_epochs: 1
    outs:
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
  MCA:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
    params:
      params.yaml:
        train.mca: data/MCA.csv
      dynamic.yaml:
        malgan.id: 984c6217d8cb4da6bd79ff089cca7355
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 7f675faffb4ed0bd8d61e61792fb8d29
      size: 76627
  split:
    cmd: python scripts/split.py
    deps:
    - path: data/raw/sleipnir/benign
      hash: md5
      md5: a94ca5d3a46622b553d9d35ef8f18f0a.dir
      size: 4037404256
      nfiles: 19696
    - path: data/raw/sleipnir/malicious
      hash: md5
      md5: c7057fcf38ebd7dc19f47bd8aef0a360.dir
      size: 7173280084
      nfiles: 34994
    params:
      params.yaml:
        split.benign_dir: data/raw/sleipnir/benign
        split.malware_dir: data/raw/sleipnir/malicious
        split.random_state: 42
        split.test_size: 0.2
        split.unique_ratio: 0.09
        train.head: 10000
        train.num_features: 200
    outs:
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: data/train/mal.npy
      hash: md5
      md5: a7f21c4df75b30601ce78ef8b64e1ee5
      size: 6400128
    - path: data/valid/ben.npy
      hash: md5
      md5: 25fa8f8bd5c522596c2fe2d88c164419
      size: 1600128
    - path: data/valid/mal.npy
      hash: md5
      md5: 418a2f874304d994b0ecc67e97b69f17
      size: 1600128
  train_malgan:
    cmd: python main.py 60 32 300 data/train/ben.npy --activation tanh data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: data/train/mal.npy
      hash: md5
      md5: a7f21c4df75b30601ce78ef8b64e1ee5
      size: 6400128
    params:
      params.yaml:
        train.Z: 60
        train.activation: tanh
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.estimators: 100
        train.malware: data/train/mal.npy
        train.name: Bachelor_10k_200-Features_random_split
        train.num_epochs: 300
      dynamic.yaml:
        detector.id: e977e9ff9f4e4c7cba0da0a2f0c20b38
  train_mca:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: data/train/mal.npy
      hash: md5
      md5: a7f21c4df75b30601ce78ef8b64e1ee5
      size: 6400128
    params:
      params.yaml:
        train.estimators: 100
        train.head: 10000
        train.mca: data/MCA.csv
        train.mca_components: 10
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: ccddfe124b0afc9c89efc6a5d2cb435f
      size: 3300302
  train_mca_classifier:
    cmd: python mca_classifier.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: ccddfe124b0afc9c89efc6a5d2cb435f
      size: 3300302
    params:
      params.yaml:
        train.estimators: 100
        train.mca: data/MCA.csv
  graph_mca:
    cmd: python scripts/graph_mca.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: ccddfe124b0afc9c89efc6a5d2cb435f
      size: 3300302
    outs:
    - path: outs/mca_scatter.html
      hash: md5
      md5: 4e98c5a1db14e754f367bc444771bfc2
      size: 4414356
  extract_normal_features:
    cmd: python lime_normal.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: ccddfe124b0afc9c89efc6a5d2cb435f
      size: 3300302
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: dynamic.yaml
      hash: md5
      md5: 5a489703ee7a07746757c1fab81d9c32
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
      dynamic.yaml:
        mca.id: 185d4140c2754cbcab3a87b6f363fc74
        mca_classifier.id: 2585cf7859fc4fe8a9f339c3699f189b
    outs:
    - path: data/normal_features.txt
      hash: md5
      md5: 6004bea69adcc59b6416193db446a347
      size: 417
  experiment_base:
    cmd: PYTHONHASHSEED=0 python experiment.py normal
    deps:
    - path: data/valid/ben.npy
      hash: md5
      md5: 25fa8f8bd5c522596c2fe2d88c164419
      size: 1600128
    - path: data/valid/mal.npy
      hash: md5
      md5: 418a2f874304d994b0ecc67e97b69f17
      size: 1600128
    - path: dynamic.yaml
      hash: md5
      md5: 5a489703ee7a07746757c1fab81d9c32
      size: 195
    params:
      params.yaml:
        metrics.normal: metrics/normal.json
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: e977e9ff9f4e4c7cba0da0a2f0c20b38
        malgan.id: e632103594624157b7cbe98f5f30f87f
    outs:
    - path: metrics/normal.json
      hash: md5
      md5: f12021c7288fdb3a028d672c523b8695
      size: 928
    - path: metrics/normal.png
      hash: md5
      md5: 8d0c40d29c161f9938428017b9e92f73
      size: 20949
  experiment_lime:
    cmd: PYTHONHASHSEED=0 python experiment.py lime
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: ccddfe124b0afc9c89efc6a5d2cb435f
      size: 3300302
    - path: data/normal_features.txt
      hash: md5
      md5: 6004bea69adcc59b6416193db446a347
      size: 417
    - path: data/valid/ben.npy
      hash: md5
      md5: 25fa8f8bd5c522596c2fe2d88c164419
      size: 1600128
    - path: data/valid/mal.npy
      hash: md5
      md5: 418a2f874304d994b0ecc67e97b69f17
      size: 1600128
    - path: dynamic.yaml
      hash: md5
      md5: 5a489703ee7a07746757c1fab81d9c32
      size: 195
    params:
      params.yaml:
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: e977e9ff9f4e4c7cba0da0a2f0c20b38
        malgan.id: e632103594624157b7cbe98f5f30f87f
        mca.id: 185d4140c2754cbcab3a87b6f363fc74
        mca_classifier.id: 2585cf7859fc4fe8a9f339c3699f189b
    outs:
    - path: metrics/lime.json
      hash: md5
      md5: e11feea937ce6562ff9358d81ac3d97e
      size: 867
    - path: metrics/lime.png
      hash: md5
      md5: ffddcb8f8dd6e442d09b32aa3a5ef528
      size: 20986
    - path: metrics/lime_obf.json
      hash: md5
      md5: e11feea937ce6562ff9358d81ac3d97e
      size: 867
    - path: metrics/lime_obf.png
      hash: md5
      md5: 2557fa93bf3c5991554114223bf02322
      size: 24229
  train_detector:
    cmd: python train_detector.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: data/train/mal.npy
      hash: md5
      md5: a7f21c4df75b30601ce78ef8b64e1ee5
      size: 6400128
    params:
      params.yaml:
        split.random_state: 42
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
  extract_normal_categorical_features:
    cmd: python lime_normal_categorical.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: e9a3fc84f73af11553b06d681320f199
      size: 6400128
    - path: dynamic.yaml
      hash: md5
      md5: 5a489703ee7a07746757c1fab81d9c32
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.normal_categorical_features: data/normal_categorical_features.txt
      dynamic.yaml:
        detector.id: e977e9ff9f4e4c7cba0da0a2f0c20b38
    outs:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 607ea153dba40a04c1709878d57df2ae
      size: 2621
  experiment_lime_categorical:
    cmd: PYTHONHASHSEED=0 python experiment.py categorical
    deps:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 607ea153dba40a04c1709878d57df2ae
      size: 2621
    - path: data/valid/ben.npy
      hash: md5
      md5: 25fa8f8bd5c522596c2fe2d88c164419
      size: 1600128
    - path: data/valid/mal.npy
      hash: md5
      md5: 418a2f874304d994b0ecc67e97b69f17
      size: 1600128
    - path: dynamic.yaml
      hash: md5
      md5: 5a489703ee7a07746757c1fab81d9c32
      size: 195
    params:
      params.yaml:
        train.normal_categorical_features: data/normal_categorical_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: e977e9ff9f4e4c7cba0da0a2f0c20b38
        malgan.id: e632103594624157b7cbe98f5f30f87f
    outs:
    - path: metrics/lime_cat.json
      hash: md5
      md5: 5f0cd3b4fcce81c6dd5977286b0c191e
      size: 873
    - path: metrics/lime_cat.png
      hash: md5
      md5: 8104b10da0d7aa9cb04bf71dcbb0a7ac
      size: 20829
    - path: metrics/lime_cat_obf.json
      hash: md5
      md5: 5f0cd3b4fcce81c6dd5977286b0c191e
      size: 873
    - path: metrics/lime_cat_obf.png
      hash: md5
      md5: f3bc50dd289bcb9bbd3d1e5d34675385
      size: 23951
