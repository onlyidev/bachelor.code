schema: '2.0'
stages:
  train:
    cmd: python main.py 10 32 1 data/train/ben.npy data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    params:
      params.yaml:
        train.Z: 10
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
        train.num_epochs: 1
    outs:
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
  MCA:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
    params:
      params.yaml:
        train.mca: data/MCA.csv
      dynamic.yaml:
        malgan.id: 984c6217d8cb4da6bd79ff089cca7355
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 7f675faffb4ed0bd8d61e61792fb8d29
      size: 76627
  split:
    cmd: python scripts/split.py
    deps:
    - path: data/raw/sleipnir/benign
      hash: md5
      md5: a94ca5d3a46622b553d9d35ef8f18f0a.dir
      size: 4037404256
      nfiles: 19696
    - path: data/raw/sleipnir/malicious
      hash: md5
      md5: c7057fcf38ebd7dc19f47bd8aef0a360.dir
      size: 7173280084
      nfiles: 34994
    params:
      params.yaml:
        split.benign_dir: data/raw/sleipnir/benign
        split.malware_dir: data/raw/sleipnir/malicious
        split.random_state: 42
        split.test_size: 0.2
    outs:
    - path: data/train/ben.npy
      hash: md5
      md5: 0a5f32ed94ec1dc773e3a6fc894e1735
      size: 32000128
    - path: data/train/mal.npy
      hash: md5
      md5: fc3b7db6b8afd4c0c8907ab0fb8d9358
      size: 32000128
    - path: data/valid/ben.npy
      hash: md5
      md5: 847dce51e2288cefd25ebdfe25950882
      size: 8000128
    - path: data/valid/mal.npy
      hash: md5
      md5: 807bb48be0b841c55b768b3260749818
      size: 8000128
  train_malgan:
    cmd: python main.py 1000 32 300 data/train/ben.npy --gen-hidden-sizes 1000 512
      256 512 1000 --activation tanh data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 0a5f32ed94ec1dc773e3a6fc894e1735
      size: 32000128
    - path: data/train/mal.npy
      hash: md5
      md5: fc3b7db6b8afd4c0c8907ab0fb8d9358
      size: 32000128
    params:
      params.yaml:
        train.Z: 1000
        train.activation: tanh
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
        train.name: Bachelor_2000_10k-Features
        train.num_epochs: 300
  train_mca:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 0a5f32ed94ec1dc773e3a6fc894e1735
      size: 32000128
    - path: data/train/mal.npy
      hash: md5
      md5: fc3b7db6b8afd4c0c8907ab0fb8d9358
      size: 32000128
    params:
      params.yaml:
        train.estimators: 100
        train.head: 1000
        train.mca: data/MCA.csv
        train.mca_components: 20
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 672aa39fc795d8f5aeca14a13a0d91b3
      size: 685544
  train_mca_classifier:
    cmd: python mca_classifier.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 672aa39fc795d8f5aeca14a13a0d91b3
      size: 685544
    params:
      params.yaml:
        train.estimators: 100
        train.mca: data/MCA.csv
  graph_mca:
    cmd: python scripts/graph_mca.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 672aa39fc795d8f5aeca14a13a0d91b3
      size: 685544
    outs:
    - path: outs/mca_scatter.html
      hash: md5
      md5: 93c1f3654cb5572891448d912229bf4a
      size: 866096
  extract_normal_features:
    cmd: python lime_normal.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 672aa39fc795d8f5aeca14a13a0d91b3
      size: 685544
    - path: data/train/ben.npy
      hash: md5
      md5: 0a5f32ed94ec1dc773e3a6fc894e1735
      size: 32000128
    - path: dynamic.yaml
      hash: md5
      md5: 5a2c48a3e2541088af3442b4c13c01ca
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
      dynamic.yaml:
        mca.id: bd6aac27a41042f499a67e2553c40266
        mca_classifier.id: 2e4a866a85414e22ad32015e302163d1
    outs:
    - path: data/normal_features.txt
      hash: md5
      md5: 45a2598ee41b58e5cbf9eb696981b9c2
      size: 717
  experiment_base:
    cmd: PYTHONHASHSEED=0 python experiment.py normal
    deps:
    - path: data/valid/ben.npy
      hash: md5
      md5: 847dce51e2288cefd25ebdfe25950882
      size: 8000128
    - path: data/valid/mal.npy
      hash: md5
      md5: 807bb48be0b841c55b768b3260749818
      size: 8000128
    - path: dynamic.yaml
      hash: md5
      md5: 5a2c48a3e2541088af3442b4c13c01ca
      size: 195
    params:
      params.yaml:
        metrics.normal: metrics/normal.json
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: f2ccc07f5e3c40df8be8617509bd851d
        malgan.id: 5ee8dce21de845f6aa60764fc213260e
    outs:
    - path: metrics/normal.json
      hash: md5
      md5: d25b419c6432e5bdcaa68a42832231e6
      size: 851
    - path: metrics/normal.png
      hash: md5
      md5: 7669cb69c9e169b03a284a95fe6f5965
      size: 20483
  experiment_lime:
    cmd: PYTHONHASHSEED=0 python experiment.py lime
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 672aa39fc795d8f5aeca14a13a0d91b3
      size: 685544
    - path: data/valid/ben.npy
      hash: md5
      md5: 847dce51e2288cefd25ebdfe25950882
      size: 8000128
    - path: data/valid/mal.npy
      hash: md5
      md5: 807bb48be0b841c55b768b3260749818
      size: 8000128
    - path: dynamic.yaml
      hash: md5
      md5: 5a2c48a3e2541088af3442b4c13c01ca
      size: 195
    params:
      params.yaml:
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: f2ccc07f5e3c40df8be8617509bd851d
        malgan.id: 5ee8dce21de845f6aa60764fc213260e
        mca.id: bd6aac27a41042f499a67e2553c40266
        mca_classifier.id: 2e4a866a85414e22ad32015e302163d1
    outs:
    - path: metrics/lime.json
      hash: md5
      md5: 15760cfebefd9bf6049ffa2a60251e43
      size: 876
    - path: metrics/lime.png
      hash: md5
      md5: 8d6ebcba6c0ea566d86900f3380453b8
      size: 18219
    - path: metrics/lime_obf.json
      hash: md5
      md5: 7a3f638a4bde40bd782d2531fe956c8a
      size: 1059
    - path: metrics/lime_obf.png
      hash: md5
      md5: 57920ce78fb5a4eeea4bea9f472b0d7a
      size: 24093
  train_detector:
    cmd: python train_detector.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 0a5f32ed94ec1dc773e3a6fc894e1735
      size: 32000128
    - path: data/train/mal.npy
      hash: md5
      md5: fc3b7db6b8afd4c0c8907ab0fb8d9358
      size: 32000128
    params:
      params.yaml:
        split.random_state: 42
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
