schema: '2.0'
stages:
  train:
    cmd: python main.py 10 32 1 data/train/ben.npy data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    params:
      params.yaml:
        train.Z: 10
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
        train.num_epochs: 1
    outs:
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
  MCA:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: 07dca973a84263d062907e19dc8031b7
      size: 1434489392
    - path: data/train/mal.npy
      hash: md5
      md5: 3b53f4382adf6b9b3122c284df107703
      size: 1434489392
    - path: dynamic.yaml
      hash: md5
      md5: 25cad90a2614a1e8ba9f069332625cad
      size: 47
    params:
      params.yaml:
        train.mca: data/MCA.csv
      dynamic.yaml:
        malgan.id: 984c6217d8cb4da6bd79ff089cca7355
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 7f675faffb4ed0bd8d61e61792fb8d29
      size: 76627
  split:
    cmd: python scripts/split.py
    deps:
    - path: data/raw/sleipnir/benign
      hash: md5
      md5: a94ca5d3a46622b553d9d35ef8f18f0a.dir
      size: 4037404256
      nfiles: 19696
    - path: data/raw/sleipnir/malicious
      hash: md5
      md5: c7057fcf38ebd7dc19f47bd8aef0a360.dir
      size: 7173280084
      nfiles: 34994
    params:
      params.yaml:
        split.benign_dir: data/raw/sleipnir/benign
        split.malware_dir: data/raw/sleipnir/malicious
        split.random_state: 42
        split.test_size: 0.2
        split.unique_ratio: 0.08
        train.head: 1000
        train.num_features: 200
    outs:
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: data/train/mal.npy
      hash: md5
      md5: eb13511616b57e5780e71b5a37a05e54
      size: 640128
    - path: data/valid/ben.npy
      hash: md5
      md5: d305f1d6eb5b7684bd17d98ec827c65a
      size: 160128
    - path: data/valid/mal.npy
      hash: md5
      md5: 3e2d690423e8d62c39e732257f11d637
      size: 160128
  train_malgan:
    cmd: python main.py 60 32 500 data/train/ben.npy --activation leakyrelu data/train/mal.npy
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: data/train/mal.npy
      hash: md5
      md5: eb13511616b57e5780e71b5a37a05e54
      size: 640128
    params:
      params.yaml:
        train.Z: 60
        train.activation: leakyrelu
        train.batch_size: 32
        train.benign: data/train/ben.npy
        train.estimators: 100
        train.malware: data/train/mal.npy
        train.name: Bachelor_1k_200-Features_lime_1
        train.num_epochs: 500
      dynamic.yaml:
        detector.id: efc9e8c60495467498b09ac8ffb4d126
  train_mca:
    cmd: python mca.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: data/train/mal.npy
      hash: md5
      md5: eb13511616b57e5780e71b5a37a05e54
      size: 640128
    params:
      params.yaml:
        train.estimators: 100
        train.head: 1000
        train.mca: data/MCA.csv
        train.mca_components: 10
    outs:
    - path: data/MCA.csv
      hash: md5
      md5: 0ba6d79a738cdec9124486c63e21a330
      size: 329672
  train_mca_classifier:
    cmd: python mca_classifier.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 0ba6d79a738cdec9124486c63e21a330
      size: 329672
    params:
      params.yaml:
        train.estimators: 100
        train.mca: data/MCA.csv
  graph_mca:
    cmd: python scripts/graph_mca.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 0ba6d79a738cdec9124486c63e21a330
      size: 329672
    outs:
    - path: outs/mca_scatter.html
      hash: md5
      md5: a553e603ab3ee2294771ab536c06ed35
      size: 442648
  extract_normal_features:
    cmd: python lime_normal.py
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 0ba6d79a738cdec9124486c63e21a330
      size: 329672
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: dynamic.yaml
      hash: md5
      md5: 9ad86a8a6fbca8336af2a814e33ed73e
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
      dynamic.yaml:
        mca.id: cb5066ff3c6b4d12a5993578316726dd
        mca_classifier.id: 299f9e2f07d64e39a15c0b3c59727414
    outs:
    - path: data/normal_features.txt
      hash: md5
      md5: 0588cc7f069bcc6b26816a4ab53eaf99
      size: 191
  experiment_base:
    cmd: PYTHONHASHSEED=0 python experiment.py normal
    deps:
    - path: data/valid/ben.npy
      hash: md5
      md5: d305f1d6eb5b7684bd17d98ec827c65a
      size: 160128
    - path: data/valid/mal.npy
      hash: md5
      md5: 3e2d690423e8d62c39e732257f11d637
      size: 160128
    - path: dynamic.yaml
      hash: md5
      md5: 9ad86a8a6fbca8336af2a814e33ed73e
      size: 195
    params:
      params.yaml:
        metrics.normal: metrics/normal.json
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: efc9e8c60495467498b09ac8ffb4d126
        malgan.id: 6d24e395441e4cd3a83aa3df479bd29b
    outs:
    - path: metrics/normal.json
      hash: md5
      md5: 9f96af675794bc438f9066d58af4dcf9
      size: 900
    - path: metrics/normal.png
      hash: md5
      md5: 68410339f32726c48548db24c665c73a
      size: 20385
  experiment_lime:
    cmd: PYTHONHASHSEED=0 python experiment.py lime
    deps:
    - path: data/MCA.csv
      hash: md5
      md5: 0ba6d79a738cdec9124486c63e21a330
      size: 329672
    - path: data/normal_features.txt
      hash: md5
      md5: 0588cc7f069bcc6b26816a4ab53eaf99
      size: 191
    - path: data/valid/ben.npy
      hash: md5
      md5: d305f1d6eb5b7684bd17d98ec827c65a
      size: 160128
    - path: data/valid/mal.npy
      hash: md5
      md5: 3e2d690423e8d62c39e732257f11d637
      size: 160128
    - path: dynamic.yaml
      hash: md5
      md5: 9ad86a8a6fbca8336af2a814e33ed73e
      size: 195
    params:
      params.yaml:
        train.mca: data/MCA.csv
        train.normal_features: data/normal_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: efc9e8c60495467498b09ac8ffb4d126
        malgan.id: 6d24e395441e4cd3a83aa3df479bd29b
        mca.id: cb5066ff3c6b4d12a5993578316726dd
        mca_classifier.id: 299f9e2f07d64e39a15c0b3c59727414
    outs:
    - path: metrics/lime.json
      hash: md5
      md5: 9f96af675794bc438f9066d58af4dcf9
      size: 900
    - path: metrics/lime.png
      hash: md5
      md5: 68410339f32726c48548db24c665c73a
      size: 20385
    - path: metrics/lime_obf.json
      hash: md5
      md5: 9f96af675794bc438f9066d58af4dcf9
      size: 900
    - path: metrics/lime_obf.png
      hash: md5
      md5: 77b0f84a78d77d2cf188087c28c1acd8
      size: 22969
  train_detector:
    cmd: python train_detector.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: data/train/mal.npy
      hash: md5
      md5: eb13511616b57e5780e71b5a37a05e54
      size: 640128
    params:
      params.yaml:
        split.random_state: 42
        train.benign: data/train/ben.npy
        train.malware: data/train/mal.npy
  extract_normal_categorical_features:
    cmd: python lime_normal_categorical.py
    deps:
    - path: data/train/ben.npy
      hash: md5
      md5: a2482875b25e3bf8fdee0aa545d4a544
      size: 640128
    - path: dynamic.yaml
      hash: md5
      md5: 9ad86a8a6fbca8336af2a814e33ed73e
      size: 195
    params:
      params.yaml:
        train.benign: data/train/ben.npy
        train.normal_categorical_features: data/normal_categorical_features.txt
      dynamic.yaml:
        detector.id: efc9e8c60495467498b09ac8ffb4d126
    outs:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 1931488441610e99a914852ef5ffc22c
      size: 1527
  experiment_lime_categorical:
    cmd: PYTHONHASHSEED=0 python experiment.py categorical
    deps:
    - path: data/normal_categorical_features.txt
      hash: md5
      md5: 1931488441610e99a914852ef5ffc22c
      size: 1527
    - path: data/valid/ben.npy
      hash: md5
      md5: d305f1d6eb5b7684bd17d98ec827c65a
      size: 160128
    - path: data/valid/mal.npy
      hash: md5
      md5: 3e2d690423e8d62c39e732257f11d637
      size: 160128
    - path: dynamic.yaml
      hash: md5
      md5: 9ad86a8a6fbca8336af2a814e33ed73e
      size: 195
    params:
      params.yaml:
        train.normal_categorical_features: data/normal_categorical_features.txt
        valid.benign: data/valid/ben.npy
        valid.malware: data/valid/mal.npy
      dynamic.yaml:
        detector.id: efc9e8c60495467498b09ac8ffb4d126
        malgan.id: 6d24e395441e4cd3a83aa3df479bd29b
    outs:
    - path: metrics/lime_cat.json
      hash: md5
      md5: 46183d87982f83569d7d5c95a5a1cd22
      size: 897
    - path: metrics/lime_cat.png
      hash: md5
      md5: 4c0752da0401dd8533daa263b7901d0e
      size: 20353
    - path: metrics/lime_cat_obf.json
      hash: md5
      md5: 46183d87982f83569d7d5c95a5a1cd22
      size: 897
    - path: metrics/lime_cat_obf.png
      hash: md5
      md5: 93e7c71a149d3adf0711cf3614567cf8
      size: 23577
